

	<body>
		<div class="page-wrapper">
			

			<main class="main">
				<div class="page-header text-center" style="background-image: url('https://demos.themeselection.com/sneat-bootstrap-html-admin-template/assets/img/pages/profile-banner.png');">
					<div class="container">
						<h1 class="page-title">My Account<span>Shop</span></h1>
					</div><!-- End .container -->
				</div><!-- End .page-header -->
				

				<div class="page-content">
					<div class="dashboard mt-4">
						<div class="container">
							<div class="row">
								<aside class="col-md-4 col-lg-3">
									<ul class="nav nav-dashboard flex-column mb-3 mb-md-0" role="tablist">
										<li class="nav-item">
											<a class="nav-link active" id="tab-dashboard-link" data-toggle="tab" href="#tab-dashboard" role="tab" aria-controls="tab-dashboard" aria-selected="true">Dashboard</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="tab-orders-link" data-toggle="tab" href="#tab-orders" role="tab" aria-controls="tab-orders" aria-selected="false">Orders</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="tab-downloads-link" data-toggle="tab" href="#tab-downloads" role="tab" aria-controls="tab-downloads" aria-selected="false">Downloads</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="tab-address-link" data-toggle="tab" href="#tab-address" role="tab" aria-controls="tab-address" aria-selected="false">Adresses</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="tab-account-link" data-toggle="tab" href="#tab-account" role="tab" aria-controls="tab-account" aria-selected="false">Account Details</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="#">Sign Out</a>
										</li>
									</ul>
								</aside><!-- End .col-lg-3 -->

								<div class="col-md-8 col-lg-9">
									<div class="tab-content">
										<div class="tab-pane fade active " id="tab-dashboard" role="tabpanel" aria-labelledby="tab-dashboard-link">
											<p>Hello <span class="font-weight-normal text-dark">User</span> (not <span class="font-weight-normal text-dark">User</span>? <a href="#">Log out</a>) 
											<br>
											From your account dashboard you can view your <a href="#tab-orders" class="tab-trigger-link link-underline">recent orders</a>, manage your <a href="#tab-address" class="tab-trigger-link">shipping and billing addresses</a>, and <a href="#tab-account" class="tab-trigger-link">edit your password and account details</a>.</p>
										</div><!-- .End .tab-pane -->

										<div class="tab-pane fade" id="tab-orders" role="tabpanel" aria-labelledby="tab-orders-link">
											<p>No order has been made yet.</p>
											<a href="category.html" class="btn btn-outline-primary-2"><span>GO SHOP</span><i class="icon-long-arrow-right"></i></a>
										</div><!-- .End .tab-pane -->

										<div class="tab-pane fade" id="tab-downloads" role="tabpanel" aria-labelledby="tab-downloads-link">
											<p>No downloads available yet.</p>
											<a href="category.html" class="btn btn-outline-primary-2"><span>GO SHOP</span><i class="icon-long-arrow-right"></i></a>
										</div><!-- .End .tab-pane -->

										<div class="tab-pane fade" id="tab-address" role="tabpanel" aria-labelledby="tab-address-link">
											<p>The following addresses will be used on the checkout page by default.</p>
											

											<div class="row">
											<% address?.address?.forEach(address=>{ %> 
												<div class="col-lg-6">
													<div class="card card-dashboard">
														<div class="card-body">
															<div class="d-flex justify-content-end">
																<svg onclick="removeAddress('<%= address._id %> ')"  xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-x mt-1" viewBox="0 0 16 16">
																	<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
																</svg>
															</div>
															<h3 class="card-title">Shipping Address</h3><!-- End .card-title -->
															<p>Name : <%= address.firstName %> <%= address.lastName  %>  <br>
															
															Address : <%= address.street  %> <br>
															Pincode : <%= address.pincode  %> <br>
															Town, Country : <%= address.town  %>,<%= address.country  %>  <br>
															Phone : <%= address.mobile  %> <br>
															Email : <%= address.email %> <br>

															<div class="d-flex justify-content-between">
																<button type="button" class="btn btn-outline-secondary" data-toggle="modal" data-target="#exampleModalLong">
																edit
															</button>
															
															</div>
															

															<!-- Modal -->
															<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
																<div class="modal-dialog" role="document">
																<div class="modal-content">
																	<div class="modal-header">
																	<h5 class="modal-title" id="exampleModalLongTitle">Edit Address</h5>
																	<button type="button" class="close" data-dismiss="modal" aria-label="Close">
																		<span aria-hidden="true">&times;</span>
																	</button>
																	</div>
																	<div class="modal-body">
																		<form action="#" class="container-fluid">
																			<div class="row">
																				<div class="col-lg-12">
																					<h2 class="checkout-title">Shipping Details</h2><!-- End .checkout-title -->
																						<div class="row">
																							<div class="col-sm-6">
																								<p></p>
																								<label>First Name *</label>
																								<input value="<%=address.firstName  %> " id="firstname" type="text" class="form-control" required>
																							</div><!-- End .col-sm-6 -->
												
																							<div class="col-sm-6">
																								<p></p>
																								<label>Last Name *</label>
																								<input value="<%= address.lastName  %>" id="lastname" type="text" class="form-control" required>
																							</div><!-- End .col-sm-6 -->
																						</div><!-- End .row -->
												
																						
																						<p></p>
																						<label>Country *</label>
																						<input value="<%= address.country %> " id="country" type="text" class="form-control" required>
																						<p></p>
																						<label>Street address *</label>
																						<input value="<%= address.street  %> " id="add" type="text" class="form-control" placeholder="House number and Street name" required>
																						
												
																						<div class="row">
																							<div class="col-sm-6">
																								<p></p>
																								<label>Town  *</label>
																								<input value="<%= address.town %> " id="town" type="text" class="form-control" required>
																							</div><!-- End .col-sm-12 -->
												
																							<div class="col-sm-6">
																								<p></p>
																								<label>State  *</label>
																								<input value="<%= address.country %> " id="state" type="text" class="form-control" required>
																							</div><!-- End .col-sm-6 -->
																						</div><!-- End .row -->
												
																						<div class="row">
																							<div class="col-sm-6">
																								<p></p>
																								<label>Postcode / ZIP *</label>
																								<input value="<%= address.pincode %> " id="pincode" type="text" class="form-control" required>
																							</div><!-- End .col-sm-6 -->
												
																							<div class="col-sm-6">
																								<p></p>
																								<label>Phone *</label>
																								<input value="<%= address.mobile  %> " id="mobile" type="tel" class="form-control" required>
																							</div><!-- End .col-sm-6 -->
																						</div><!-- End .row -->
																						<p></p>
																						<label>Email address *</label>
																						<input value="<%= address.email %> " id="email" type="email" class="form-control" required>
												
																						
																				</div><!-- End .col-lg-9 -->
																				
																			</div><!-- End .row -->
																		</form>
																	</div>
																	<div class="modal-footer">
																	<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
																	<button onclick="submitAddress('<%= address._id %>')" type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button>
																	</div>
																</div>
																</div>
															</div>


														</div><!-- End .card-body -->
													</div><!-- End .card-dashboard -->
												</div><!-- End .col-lg-6 -->
												<% }) %> 
											</div><!-- End .row -->
											

											<!-- Button trigger modal -->
											<button type="button" class="btn btn-outline-success py-1 mx-1" data-toggle="modal" data-target="#exampleModalLongadd">
												<svg  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus mx-1" viewBox="0 0 16 16">
													<path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
												</svg>Add address
											</button>

											<!-- Modal -->
											<div class="modal fade" id="exampleModalLongadd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
												<div class="modal-dialog" role="document">
												<div class="modal-content">
													<div class="modal-header">
													<h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
													<button type="button" class="close" data-dismiss="modal" aria-label="Close">
														<span aria-hidden="true">&times;</span>
													</button>
													</div>
													<div class="modal-body">
														<form action="" class="container-fluid">
															<div class="row">
																<div class="col-lg-12">
																	<h2 class="checkout-title">Shipping Details</h2><!-- End .checkout-title -->
																		<div class="row">
																			<div class="col-sm-6">
																				<p>dd</p>
																				<label>First Name *</label>
																				<input  id="firstname2" type="text" class="form-control" required>
																			</div><!-- End .col-sm-6 -->
								
																			<div class="col-sm-6">
																				<label>Last Name *</label>
																				<input id="lastname2" type="text" class="form-control" required>
																			</div><!-- End .col-sm-6 -->
																		</div><!-- End .row -->
								
																		
								
																		<label>Country *</label>
																		<input id="country2"  type="text" class="form-control" required>
								
																		<label>Street address *</label>
																		<input  id="add2" type="text" class="form-control" placeholder="House number and Street name" required>
																		
								
																		<div class="row">
																			<div class="col-sm-6">
																				<label>Town  *</label>
																				<input id="town2"  type="text" class="form-control" required>
																			</div><!-- End .col-sm-12 -->
								
																			<div class="col-sm-6">
																				<label>State  *</label>
																				<input id="state2" type="text" class="form-control" required>
																			</div><!-- End .col-sm-6 -->
																		</div><!-- End .row -->
								
																		<div class="row">
																			<div class="col-sm-6">
																				<label>Postcode / ZIP *</label>
																				<input id="pincode2" type="text" class="form-control" required>
																			</div><!-- End .col-sm-6 -->
								
																			<div class="col-sm-6">
																				<label>Phone *</label>
																				<input id="mobile2" type="tel" class="form-control" required>
																			</div><!-- End .col-sm-6 -->
																		</div><!-- End .row -->
								
																		<label>Email address *</label>
																		<input id="email2" type="email" class="form-control" required>
								
																		
																</div><!-- End .col-lg-9 -->
																
															</div><!-- End .row -->
														</form>
													</div>
													<div class="modal-footer">
													<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
													<button onclick="addAddress()" type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button>
													</div>
												</div>
												</div>
											</div>  
										


											
										</div><!-- .End .tab-pane -->

										<div class="tab-pane fade" id="tab-account" role="tabpanel" aria-labelledby="tab-account-link">
											<section>
												<div class="container">
												  <div class="row">
													<div class="col-lg-4">
													  <!-- <div class="card mb-4"> -->
														<div class="card-body text-center">
														  <img  src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
															class="rounded-circle img-fluid ml-5" style="width: 150px;margin-left: 9rem!important;">
														  <h5 class="my-3 mb-4" ><%= user.name  %> </h5>
														  <!-- <p class="text-muted mb-1">Full Stack Developer</p>
														  <p class="text-muted mb-4">Bay Area, San Francisco, CA</p> -->
														  <div class="d-flex justify-content-center mb-2">
															<button type="button" class="btn btn-primary">Upload Image</button>
															<!-- modal button -->
															<button type="button" class="btn btn-outline-primary ms-1" data-toggle="modal" data-target="#exampleModalCenter">
																Edit
															</button>
															<!-- modal button end-->

															<!-- modal form -->
															<!-- Modal -->
															<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
																<div class="modal-dialog modal-dialog-centered" role="document">
																  <div class="modal-content">
																	<div class="modal-header">
																	  <h5 class="modal-title " id="exampleModalLongTitle">Edit Profile <p class="text-danger" id="error"></p></h5>
																	  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
																		<span aria-hidden="true">&times;</span>
																	  </button>
																	</div>
																	<div class="modal-body">
																		<form action="#" class="container-fluid">
																			<div class="row">
																				<div class="col-sm-12">
																					<label>Name </label>
																					<input id="name" value="<%= user.name  %> " type="text" class="form-control" required>
																				</div><!-- End .col-sm-6 -->
																			</div><!-- End .row -->
								
																			
								
																			<label>Email address </label>
																			<input id="email3" value="<%= user.email  %>"  type="email" class="form-control" required>
								
																			<label>Current password </label>
																			<input id="currentpassword" type="password" class="form-control">
								
																			<label>New password</label>
																			<input id="password"  type="password" class="form-control">
								
																			<label>Confirm new password</label>
																			<input id="password2" type="password" class="form-control mb-2">
								
																			
																		</form>
																	</div>
																	<div class="modal-footer">
																	  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
																	  <button onclick="changeUserData()" type="button" class="btn btn-primary">Save changes</button>
																	</div>
																  </div>
																</div>
															  </div>
															<!-- modal form start -->
														  </div>
														</div>
													  <!-- </div> -->
													</div>
													<div class="col-lg-4">
													  <div class="card mb-4">
														<div class="card-body">
														  <div class="row">
															<div class="col-3">
															  <p class="mb-0">Name</p>
															</div>
															<div class="col-sm-9">
															  <p class="text-muted mb-0"><%= user.name%></p>
															</div>
														  </div>
														  <hr>
														  <div class="row">
															<div class="col-sm-3">
															  <p class="mb-0">Email</p>
															</div>
															<div class="col-sm-9">
															  <p class="text-muted mb-0"><%= user.email  %> </p>
															</div>
														  </div>
														  <hr>
														  <div class="row">
															<div class="col-sm-3">
															  <p class="mb-0">Phone</p>
															</div>
															<div class="col-sm-9">
															  <p class="text-muted mb-0"><%= user.mobile %> </p>
															</div>
														  </div>
														  
														  
														 
														  
														
														</div>
													  </div>
													  
												  </div>
												</div>
											  </section>
										</div><!-- .End .tab-pane -->
									</div>
								</div><!-- End .col-lg-9 -->
							</div><!-- End .row -->
						</div><!-- End .container -->
					</div><!-- End .dashboard -->
				</div><!-- End .page-content -->
			</main><!-- End .main -->

			
		</div><!-- End .page-wrapper -->
		<button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>

		



	<!-- molla/dashboard.html  22 Nov 2019 10:03:13 GMT -->
	</html>

	<script>
		function removeAddress(addressId){
			
			Swal.fire({
				title: 'Are you sure?',
				text: "You won't be able to revert this!",
				icon: 'warning',
				showCancelButton: true,
				confirmButtonColor: '#3085d6',
				cancelButtonColor: '#d33',
				confirmButtonText: 'Yes, delete it!'
					}).then((result) => {
						if (result.isConfirmed) {
							Swal.fire(
							'Deleted!',
							'Your file has been deleted.',
							'success'
						)
							console.log('called ajax');
						$.ajax({
							url:'/remove-address/'+addressId,
							method:'get',
							success:(response)=>{
							
								console.log('inside success');
							}
						})

						}
					})
		}
		function submitAddress(addressId){
		

			
					console.log('called submit');
			$.ajax({
					url:'/edit-address',
					method:'post',
					data:{
					 firstname : document.getElementById('firstname').value,
        			 lastname : document.getElementById('lastname').value,
        			 country : document.getElementById('country').value,
        			 street : document.getElementById('add').value,
        			 town : document.getElementById('town').value,
        			 state : document.getElementById('state').value,
        			 pincode : document.getElementById('pincode').value,
        			 mobile : document.getElementById('mobile').value,
        			 email : document.getElementById('email').value,
					 _id:addressId
									},
					success:(response)=>{
						console.log('address updated');
						location.reload()
						
						
					}
				})
		}

		function addAddress(addressId) {
			console.log('add address called');

			$.ajax({
				url:'/add-address',
				method:'post',
				data:{
					firstname : document.getElementById('firstname2').value,
        			lastname : document.getElementById('lastname2').value,
        			country : document.getElementById('country2').value,
        			street : document.getElementById('add2').value,
        			town : document.getElementById('town2').value,
        			state : document.getElementById('state2').value,
        			pincode : document.getElementById('pincode2').value,
        			mobile : document.getElementById('mobile2').value,
        			email : document.getElementById('email2').value,
				},
				success:(response)=>{
					location.reload()
				}
			})
		}

		function changeUserData() {
			console.log('called changfe user data');
			const name=document.getElementById('name').value
			const email=document.getElementById('email3').value
			const currentPassword=document.getElementById('currentpassword').value
			const password=document.getElementById('password').value
			const password2=document.getElementById('password2').value

			let flag=2
			if(password!=password2){
				Swal.fire({
  					title: 'Password do not match',
  					showClass: {
  					  popup: 'animate__animated animate__fadeInDown'
  					},
  					hideClass: {
  					  popup: 'animate__animated animate__fadeOutUp'
 					}
				})
				flag=1
			}

			if(flag==2){

				$.ajax({
					url:'/update-user-info',
					method:'post',
					data:{
						name:name,
						email:email,
						password:currentPassword,
						newPassword:password2
						
					},
					
					success:(response)=>{
						if(response.status){
							Swal.fire({
 							position: 'top-end',
 							icon: 'success',
 							title: 'Your work has been saved',
 							showConfirmButton: false,
 							timer: 1500
							})
							setTimeout(() => {
								location.reload()
							}, 1510);
							
						}
						else{
							Swal.fire({
 								title: 'your old password is inorrect',
 								showClass: {
 								  popup: 'animate__animated animate__fadeInDown'
 								},
 								hideClass: {
 								  popup: 'animate__animated animate__fadeOutUp'
 							 }
							})
						}
					}
				})
			}
		}
	


		

	
	</script>